\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{agda}
\usepackage[utf8]{inputenc}
\usepackage{newunicodechar}

\newunicodechar{ℕ}{\ensuremath{\mathnormal\mathbb{N}}}
\newunicodechar{∞}{\ensuremath{\mathnormal\infty}}
\newunicodechar{→}{\ensuremath{\mathnormal\rightarrow}}
\newunicodechar{₁}{\ensuremath{_1}}
\newunicodechar{₂}{\ensuremath{_2}}
\newunicodechar{₃}{\ensuremath{_3}}
\newunicodechar{♯}{\ensuremath{\mathnormal\sharp}}
\newunicodechar{≡}{\ensuremath{\mathnormal\equiv}}
\newunicodechar{λ}{\ensuremath{\mathnormal\lambda}}
\newunicodechar{≈}{\ensuremath{\mathnormal\approx}}

\begin{document}

\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--guardedness}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--allow-unsolved-metas}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Language}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Traces}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Codata.Musical.Notation}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{BigRel}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{execDeterministic}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{exloop}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exloopincrementing}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Trace₁}\<%
\\
\>[0]\<%
\end{code}

\begin{code}%
\>[0]\AgdaFunction{exloopincrementing}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Swhile}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Sassign}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaFunction{add1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{startState}\AgdaSpace{}%
\AgdaFunction{incrementingtrace}\<%
\\
\>[0]\AgdaFunction{exloopincrementing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{t}\AgdaSpace{}%
\AgdaFunction{startState}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{t}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Swhile}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Sassign}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaFunction{add1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{incrementingFrom}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{t}%
\>[56I]\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{execWhileLoop}\<%
\\
\>[56I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tnil}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{update}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add1}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{))))))}\<%
\\
%
\>[12]\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[12]\AgdaInductiveConstructor{\AgdaUnderscore{}≡\AgdaUnderscore{}.refl}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaInductiveConstructor{execseqCons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaInductiveConstructor{execseqNil}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{execAssign}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaInductiveConstructor{tnil}\AgdaSymbol{)))))}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaInductiveConstructor{execseqCons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{execseqCons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{execseqNil}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{next}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)))))))}\<%
\end{code}

\begin{code}%
\>[0]\AgdaFunction{execDeterministic}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Stmt}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{tr₁}\AgdaSpace{}%
\AgdaBound{tr₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Trace₁}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{tr₁}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{tr₂}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{tr₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≈}}\AgdaSpace{}%
\AgdaBound{tr₂}\<%
\end{code}

\begin{code}%
\>[0]\AgdaComment{--\ Shut\ agda\ up\ about\ lack\ of\ implementation}\<%
\\
\>[0]\AgdaFunction{execDeterministic}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaHole{\{!\ \ \ !\}}\<%
\end{code}


\end{document}