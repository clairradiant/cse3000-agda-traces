\documentclass{article}

\usepackage{agda}

\begin{document}

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--guardedness}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Codata.Musical.Notation}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.Core}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Rel}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.Bundles}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Setoid}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.Definitions}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Reflexive}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Symmetric}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Transitive}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{eqSym}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{eqTrans}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Level}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{zero}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Maybe}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Maybe.Properties}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Bool}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{case\AgdaUnderscore{}of\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{nakata.Traces}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{nakata.Language}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{nakata.BigRel}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{execDeterministic}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{exloop}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exloopincrementing}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{incrementingFrom}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{incrementingtrace}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{increasing}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{incrementingAlwaysIncrements}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Trace₁}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{latex.ProofProgram}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\<%
\end{code}

\begin{code}%
\>[0]\AgdaFunction{incrementingFrom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Trace₁}\<%
\\
\>[0]\AgdaFunction{incrementingFrom}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{incrementingFrom}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{next}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{))))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{incrementingtrace}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Trace₁}\<%
\\
\>[0]\AgdaFunction{incrementingtrace}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{incrementingFrom}\AgdaSpace{}%
\AgdaFunction{startState}\<%
\end{code}
\begin{code}%
\>[0]\AgdaFunction{exloopincrementing}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Swhile}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Sassign}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaFunction{add1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{startState}\AgdaSpace{}%
\AgdaFunction{incrementingtrace}\<%
\\
\>[0]\AgdaFunction{exloopincrementing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{forever}\AgdaSpace{}%
\AgdaFunction{startState}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{forever}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Swhile}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Sassign}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaFunction{add1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{incrementingFrom}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{forever}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{execWhileLoop}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tnil}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{update}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add1}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{))))))}\<%
\\
%
\>[12]\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[12]\AgdaInductiveConstructor{\AgdaUnderscore{}≡\AgdaUnderscore{}.refl}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaInductiveConstructor{execseqCons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaInductiveConstructor{execseqNil}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{execAssign}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaInductiveConstructor{tnil}\AgdaSymbol{)))))}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaInductiveConstructor{execseqCons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{execseqCons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{execseqNil}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{forever}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{next}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)))))))}\<%
\end{code}

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{postulate}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaPostulate{trace}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Trace₁}\<%
\\
%
\>[4]\AgdaPostulate{program}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Stmt}\<%
\\
%
\>[4]\AgdaPostulate{fromState}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\<%
\\
%
\>[4]\AgdaPostulate{proof}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaPostulate{program}\AgdaSpace{}%
\AgdaPostulate{fromState}\AgdaSpace{}%
\AgdaPostulate{trace}\<%
\\
\>[0]\<%
\end{code}

\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{increasing}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Id}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Val}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Trace₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{increasingCons}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{id}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Id}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Val}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{tr}\AgdaSpace{}%
\AgdaBound{tr₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Trace₁}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{id}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{v}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{tr₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≈}}\AgdaSpace{}%
\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSymbol{)))}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{∞}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{increasing}\AgdaSpace{}%
\AgdaBound{id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{tr}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{increasing}\AgdaSpace{}%
\AgdaBound{id}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{tr₁}\<%
\end{code}

\begin{code}%
\>[0]\AgdaFunction{incrementingAlwaysIncrements}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{increasing}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaFunction{incrementingtrace}\<%
\\
\>[0]\AgdaFunction{incrementingAlwaysIncrements}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{forever}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Setoid}\AgdaSpace{}%
\AgdaFunction{setoid₁}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{()}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{refl}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{≈refl}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\<%
\\
%
\>[8]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{≡-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lem₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[8]\AgdaFunction{lem₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\>[8]\AgdaFunction{lem₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaFunction{≡⟨⟩}\<%
\\
%
\>[12]\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\<%
\\
%
\>[12]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lem₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
%
\>[12]\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{lem₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Val}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{next}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{v}\<%
\\
%
\>[8]\AgdaFunction{lem₂}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{next}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaNumber{0}\<%
\\
%
\>[12]\AgdaFunction{≡⟨⟩}\<%
\\
%
\>[12]\AgdaBound{st}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaNumber{1}\<%
\\
%
\>[12]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
%
\>[12]\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaNumber{1}\<%
\\
%
\>[12]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{lem₁}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
%
\>[12]\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{v}\<%
\\
%
\>[12]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaFunction{forever}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Val}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{increasing}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{incrementingFrom}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{forever}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{increasingCons}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{tcons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaFunction{≈refl}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaCoinductiveConstructor{♯}}\AgdaSpace{}%
\AgdaFunction{forever}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lem₂}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\end{code}

\begin{code}%
\>[0]\AgdaKeyword{postulate}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaPostulate{execDeterministic}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Stmt}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{tr₁}\AgdaSpace{}%
\AgdaBound{tr₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Trace₁}\AgdaSymbol{\}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{tr₁}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{exec}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{tr₂}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{tr₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≈}}\AgdaSpace{}%
\AgdaBound{tr₂}\<%
\end{code}
\end{document}